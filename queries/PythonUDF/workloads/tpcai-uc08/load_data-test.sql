CREATE TABLE tpcai_uc08 AS
SELECT * FROM read_csv('/volumn/Retree_exp/workloads/tpcai-uc08/data-extension/?/tpcai-uc08-test.csv', header=True, columns={
    'scan_count' : 'INT64',
    'scan_count_abs' : 'INT64',
    'Friday' : 'FLOAT',
    'Monday' : 'FLOAT',
    'Saturday' : 'FLOAT',
    'Sunday' : 'FLOAT',
    'Thursday' : 'FLOAT',
    'Tuesday' : 'FLOAT',
    'Wednesday' : 'FLOAT',
    'AUTOMOTIVE' : 'FLOAT',
    'BAKERY' : 'FLOAT',
    'SHEER_HOSIERY' : 'FLOAT',
    'OTHER_DEPARTMENTS' : 'FLOAT',
    'FURNITURE' : 'FLOAT',
    'SWIMWEAR_OUTERWEAR' : 'FLOAT',
    'OPTICAL__FRAMES' : 'FLOAT',
    'ACCESSORIES' : 'FLOAT',
    'MENSWEAR' : 'FLOAT',
    'LARGE_HOUSEHOLD_GOODS' : 'FLOAT',
    'PLUS_AND_MATERNITY' : 'FLOAT',
    'LADIES_SOCKS' : 'FLOAT',
    'CONCEPT_STORES' : 'FLOAT',
    'OPTICAL__LENSES' : 'FLOAT',
    'HR_PHOTO' : 'FLOAT',
    'BOOKS_AND_MAGAZINES' : 'FLOAT',
    'BRAS__SHAPEWEAR' : 'FLOAT',
    'PRE_PACKED_DELI' : 'FLOAT',
    'SEAFOOD' : 'FLOAT',
    'HEALTH_AND_BEAUTY_AIDS' : 'FLOAT',
    'SLEEPWEAR_FOUNDATIONS' : 'FLOAT',
    'SEASONAL' : 'FLOAT',
    'CAMERAS_AND_SUPPLIES' : 'FLOAT',
    'BATH_AND_SHOWER' : 'FLOAT',
    'BEAUTY' : 'FLOAT',
    'BEDDING' : 'FLOAT',
    'BOYS_WEAR' : 'FLOAT',
    'CANDY_TOBACCO_COOKIES' : 'FLOAT',
    'CELEBRATION' : 'FLOAT',
    'COMM_BREAD' : 'FLOAT',
    'COOK_AND_DINE' : 'FLOAT',
    'DAIRY' : 'FLOAT',
    'DSD_GROCERY' : 'FLOAT',
    'ELECTRONICS' : 'FLOAT',
    'FABRICS_AND_CRAFTS' : 'FLOAT',
    'FINANCIAL_SERVICES' : 'FLOAT',
    'FROZEN_FOODS' : 'FLOAT',
    'GIRLS_WEAR_46X__AND_714' : 'FLOAT',
    'GROCERY_DRY_GOODS' : 'FLOAT',
    'HARDWARE' : 'FLOAT',
    'HOME_DECOR' : 'FLOAT',
    'HOME_MANAGEMENT' : 'FLOAT',
    'HORTICULTURE_AND_ACCESS' : 'FLOAT',
    'HOUSEHOLD_CHEMICALS_SUPP' : 'FLOAT',
    'HOUSEHOLD_PAPER_GOODS' : 'FLOAT',
    'IMPULSE_MERCHANDISE' : 'FLOAT',
    'INFANT_APPAREL' : 'FLOAT',
    'INFANT_CONSUMABLE_HARDLINES' : 'FLOAT',
    'JEWELRY_AND_SUNGLASSES' : 'FLOAT',
    'LADIESWEAR' : 'FLOAT',
    'LAWN_AND_GARDEN' : 'FLOAT',
    'LIQUORWINEBEER' : 'FLOAT',
    'MEAT__FRESH__FROZEN' : 'FLOAT',
    'MEDIA_AND_GAMING' : 'FLOAT',
    'MENS_WEAR' : 'FLOAT',
    'OFFICE_SUPPLIES' : 'FLOAT',
    'PAINT_AND_ACCESSORIES' : 'FLOAT',
    'PERSONAL_CARE' : 'FLOAT',
    'PETS_AND_SUPPLIES' : 'FLOAT',
    'PHARMACY_OTC' : 'FLOAT',
    'PHARMACY_RX' : 'FLOAT',
    'PLAYERS_AND_ELECTRONICS' : 'FLOAT',
    'PRODUCE' : 'FLOAT',
    'SERVICE_DELI' : 'FLOAT',
    'SHOES' : 'FLOAT',
    'SPORTING_GOODS' : 'FLOAT',
    'TOYS' : 'FLOAT',
    'WIRELESS' : 'FLOAT'
});

EXPLAIN ANALYZE
SELECT
    count(*)
FROM
    tpcai_uc08
WHERE
    predict (
        '/volumn/Retree_exp/workloads/tpcai-uc08/model/?.onnx',
    scan_count,
    scan_count_abs,
    Friday,
    Monday,
    Saturday,
    Sunday,
    Thursday,
    Tuesday,
    Wednesday,
    AUTOMOTIVE,
    BAKERY,
    SHEER_HOSIERY,
    OTHER_DEPARTMENTS,
    FURNITURE,
    SWIMWEAR_OUTERWEAR,
    OPTICAL__FRAMES,
    ACCESSORIES,
    MENSWEAR,
    LARGE_HOUSEHOLD_GOODS,
    PLUS_AND_MATERNITY,
    LADIES_SOCKS,
    CONCEPT_STORES,
    OPTICAL__LENSES,
    HR_PHOTO,
    BOOKS_AND_MAGAZINES,
    BRAS__SHAPEWEAR,
    PRE_PACKED_DELI,
    SEAFOOD,
    HEALTH_AND_BEAUTY_AIDS,
    SLEEPWEAR_FOUNDATIONS,
    SEASONAL,
    CAMERAS_AND_SUPPLIES,
    BATH_AND_SHOWER,
    BEAUTY,
    BEDDING,
    BOYS_WEAR,
    CANDY_TOBACCO_COOKIES,
    CELEBRATION,
    COMM_BREAD,
    COOK_AND_DINE,
    DAIRY,
    DSD_GROCERY,
    ELECTRONICS,
    FABRICS_AND_CRAFTS,
    FINANCIAL_SERVICES,
    FROZEN_FOODS,
    GIRLS_WEAR_46X__AND_714,
    GROCERY_DRY_GOODS,
    HARDWARE,
    HOME_DECOR,
    HOME_MANAGEMENT,
    HORTICULTURE_AND_ACCESS,
    HOUSEHOLD_CHEMICALS_SUPP,
    HOUSEHOLD_PAPER_GOODS,
    IMPULSE_MERCHANDISE,
    INFANT_APPAREL,
    INFANT_CONSUMABLE_HARDLINES,
    JEWELRY_AND_SUNGLASSES,
    LADIESWEAR,
    LAWN_AND_GARDEN,
    LIQUORWINEBEER,
    MEAT__FRESH__FROZEN,
    MEDIA_AND_GAMING,
    MENS_WEAR,
    OFFICE_SUPPLIES,
    PAINT_AND_ACCESSORIES,
    PERSONAL_CARE,
    PETS_AND_SUPPLIES,
    PHARMACY_OTC,
    PHARMACY_RX,
    PLAYERS_AND_ELECTRONICS,
    PRODUCE,
    SERVICE_DELI,
    SHOES,
    SPORTING_GOODS,
    TOYS,
    WIRELESS
    ) = ?;